<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Australia Trip Journal</title>
  <meta name="description" content="A travel blog for my upcoming trip to Australia — itinerary, posts, photos, packing list, and budget." />
  <style>
    :root{
      --bg:#0b1020;
      --panel: rgba(255,255,255bosy,.06);
      --panel2: rgba(255,255,255,.09);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.72);
      --line: rgba(255,255,255,.12);
      --accent:#6ae4ff;
      --accent2:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --shadow: 0 16px 60px rgba(0,0,0,.45);
      --radius: 18px;
      --radius2: 26px;
      --max: 1120px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 15% 0%, rgba(106,228,255,.18), transparent 60%),
        radial-gradient(900px 500px at 80% 10%, rgba(167,139,250,.18), transparent 60%),
        radial-gradient(900px 900px at 40% 120%, rgba(52,211,153,.08), transparent 55%),
        var(--bg);
      line-height:1.4;
    }
    a{color:inherit; text-decoration:none}
    .wrap{max-width:var(--max); margin:0 auto; padding:28px 18px 70px}
    .topbar{
      position:sticky; top:0; z-index:50;
      backdrop-filter: blur(10px);
      background: linear-gradient(to bottom, rgba(11,16,32,.86), rgba(11,16,32,.62));
      border-bottom:1px solid var(--line);
    }
    .topbar .inner{max-width:var(--max); margin:0 auto; padding:12px 18px; display:flex; gap:12px; align-items:center; justify-content:space-between}
    .brand{
      display:flex; align-items:center; gap:12px; min-width: 240px;
    }
    .logo{
      width:38px; height:38px; border-radius:14px;
      background: radial-gradient(circle at 30% 30%, var(--accent), transparent 60%),
                  radial-gradient(circle at 70% 70%, var(--accent2), transparent 60%),
                  rgba(255,255,255,.08);
      box-shadow: 0 10px 28px rgba(0,0,0,.35);
      border:1px solid var(--line);
    }
    .brand h1{font-size:14px; margin:0; letter-spacing:.4px}
    .brand p{margin:0; font-size:12px; color:var(--muted)}
    nav{
      display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end;
    }
    nav a{
      font-size:13px; color:var(--muted);
      padding:8px 10px;
      border-radius: 999px;
      border:1px solid transparent;
    }
    nav a:hover{color:var(--text); border-color: var(--line); background: rgba(255,255,255,.05)}
    .hero{
      margin-top:18px;
      display:grid;
      grid-template-columns: 1.25fr .75fr;
      gap:18px;
      align-items:stretch;
    }
    @media (max-width: 900px){
      .hero{grid-template-columns: 1fr; }
      .brand{min-width:auto}
    }
    .card{
      background: linear-gradient(180deg, var(--panel), rgba(255,255,255,.03));
      border:1px solid var(--line);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
    }
    .heroMain{padding:24px; overflow:hidden; position:relative}
    .heroMain::before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(500px 220px at 20% 0%, rgba(106,228,255,.18), transparent 60%),
                  radial-gradient(520px 260px at 85% 20%, rgba(167,139,250,.18), transparent 60%);
      pointer-events:none;
      opacity:.9;
    }
    .heroMain > *{position:relative}
    .kicker{
      display:inline-flex; align-items:center; gap:8px;
      padding:7px 11px;
      border-radius: 999px;
      background: rgba(255,255,255,.05);
      border: 1px solid var(--line);
      font-size: 12px;
      color: var(--muted);
    }
    .dot{
      width:8px; height:8px; border-radius:50%;
      background: var(--good);
      box-shadow: 0 0 0 6px rgba(52,211,153,.12);
    }
    .heroTitle{margin:14px 0 10px; font-size: 38px; line-height:1.05; letter-spacing: -.6px}
    .heroTitle span{background: linear-gradient(90deg, var(--accent), var(--accent2)); -webkit-background-clip:text; background-clip:text; color:transparent}
    .heroSub{margin:0; color:var(--muted); font-size:15px; max-width: 70ch}
    .heroActions{margin-top:18px; display:flex; gap:10px; flex-wrap:wrap}
    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      gap:8px;
      padding:11px 14px;
      border-radius: 12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      color: var(--text);
      font-size: 13px;
      cursor:pointer;
      transition: transform .08s ease, background .2s ease, border-color .2s ease;
      user-select:none;
    }
    .btn:hover{background: rgba(255,255,255,.09); border-color: rgba(255,255,255,.18)}
    .btn:active{transform: translateY(1px)}
    .btnPrimary{
      background: linear-gradient(90deg, rgba(106,228,255,.18), rgba(167,139,250,.18));
      border-color: rgba(255,255,255,.22);
    }
    .btnSmall{padding:8px 10px; border-radius: 999px; font-size:12px}
    .heroSide{padding:18px}
    .statGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    .stat{
      border:1px solid var(--line);
      border-radius: 16px;
      padding:12px;
      background: rgba(255,255,255,.04);
    }
    .stat .label{color:var(--muted); font-size:12px}
    .stat .value{font-size:18px; margin-top:6px}
    .stat .mini{margin-top:4px; color:var(--muted); font-size:12px}
    .section{
      margin-top:22px;
      padding:18px;
    }
    .sectionHeader{
      display:flex; align-items:flex-end; justify-content:space-between; gap:12px;
      margin-bottom: 12px;
    }
    .sectionHeader h2{margin:0; font-size:18px}
    .sectionHeader p{margin:0; color:var(--muted); font-size:13px}
    .grid2{
      display:grid; gap:16px;
      grid-template-columns: 1fr 1fr;
    }
    @media (max-width: 900px){ .grid2{grid-template-columns:1fr} }
    .itinerary{
      display:grid; gap:10px;
    }
    .day{
      border:1px solid var(--line);
      border-radius: 16px;
      padding:12px;
      background: rgba(255,255,255,.04);
      display:grid;
      grid-template-columns: 110px 1fr;
      gap:12px;
      align-items:start;
    }
    @media (max-width: 520px){
      .day{grid-template-columns:1fr}
    }
    .day .pill{
      display:inline-flex; align-items:center; gap:8px;
      font-size:12px; color:var(--muted);
      padding:8px 10px;
      border-radius: 999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      width: fit-content;
    }
    .badge{
      display:inline-flex;
      font-size:11px;
      padding:4px 8px;
      border-radius: 999px;
      border:1px solid var(--line);
      color: var(--muted);
      background: rgba(255,255,255,.04);
      margin-left:8px;
    }
    .day h3{margin:8px 0 6px; font-size:15px}
    .day ul{margin:8px 0 0 18px; color:var(--muted); font-size:13px}
    .day a.map{
      display:inline-flex; gap:8px; align-items:center;
      margin-top:10px;
      color: var(--text);
      font-size:12px;
      padding:8px 10px;
      border-radius: 12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      width: fit-content;
    }
    .posts{
      display:grid; gap:12px;
    }
    .post{
      border:1px solid var(--line);
      border-radius: 16px;
      padding:14px;
      background: rgba(255,255,255,.04);
    }
    .postMeta{display:flex; gap:10px; flex-wrap:wrap; align-items:center; color:var(--muted); font-size:12px}
    .post h3{margin:8px 0 8px; font-size:16px}
    .post p{margin:0; color:var(--muted); font-size:13px}
    .gallery{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap:10px;
    }
    .ph{
      border:1px solid var(--line);
      border-radius: 16px;
      background: rgba(255,255,255,.04);
      overflow:hidden;
      min-height: 120px;
      position:relative;
      cursor:pointer;
      transition: transform .12s ease;
    }
    .ph:hover{transform: translateY(-2px)}
    .ph::before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(300px 180px at 20% 20%, rgba(106,228,255,.18), transparent 60%),
        radial-gradient(260px 200px at 80% 80%, rgba(167,139,250,.18), transparent 60%);
      opacity:.9;
    }
    .ph span{
      position:absolute; left:12px; bottom:10px;
      font-size:12px; color: rgba(255,255,255,.85);
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.14);
      padding:6px 8px;
      border-radius: 999px;
      backdrop-filter: blur(8px);
    }
    .col-6{grid-column: span 6}
    .col-4{grid-column: span 4}
    .col-8{grid-column: span 8}
    @media (max-width: 900px){
      .col-6,.col-4,.col-8{grid-column: span 12}
    }

    .controls{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:flex-end;
    }
    input, textarea{
      width:100%;
      padding:11px 12px;
      border-radius: 14px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      color: var(--text);
      outline:none;
      font-size: 13px;
    }
    textarea{min-height: 110px; resize: vertical}
    input::placeholder, textarea::placeholder{color: rgba(255,255,255,.45)}
    .row{
      display:grid; grid-template-columns: 1fr 1fr; gap:12px;
    }
    @media (max-width: 700px){ .row{grid-template-columns:1fr} }

    .list{
      display:grid; gap:10px;
    }
    .listItem{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:10px 12px;
      border:1px solid var(--line);
      border-radius: 14px;
      background: rgba(255,255,255,.04);
    }
    .listItem label{display:flex; gap:10px; align-items:center; color:var(--muted); font-size:13px}
    .listItem input[type="checkbox"]{width:18px; height:18px}
    .listItem .amt{color:var(--muted); font-size:12px}
    .footer{
      margin-top:26px;
      color: var(--muted);
      font-size: 12px;
      text-align:center;
    }

    /* modal */
    .modal{
      position:fixed; inset:0; z-index:100;
      display:none;
      align-items:center; justify-content:center;
      background: rgba(0,0,0,.65);
      backdrop-filter: blur(8px);
      padding: 18px;
    }
    .modal.show{display:flex}
    .modalCard{
      width:min(860px, 100%);
      border-radius: 22px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(15,18,34,.82);
      box-shadow: 0 20px 70px rgba(0,0,0,.55);
      overflow:hidden;
    }
    .modalTop{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:12px 12px 0 12px;
    }
    .modalTitle{color:var(--muted); font-size:12px}
    .modalBody{
      padding: 12px;
    }
    .modalImg{
      height: 420px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      background:
        radial-gradient(420px 220px at 20% 20%, rgba(106,228,255,.22), transparent 60%),
        radial-gradient(380px 260px at 80% 70%, rgba(167,139,250,.22), transparent 60%),
        rgba(255,255,255,.04);
    }
    .toast{
      position: fixed;
      right: 14px;
      bottom: 14px;
      z-index: 120;
      display:none;
      padding: 10px 12px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(15,18,34,.85);
      color: var(--muted);
      box-shadow: 0 14px 50px rgba(0,0,0,.45);
      font-size:12px;
    }
    .toast.show{display:block}
/* --- Rotating photo background --- */
.bg-rotator {
  position: fixed;
  inset: 0;
  z-index: -5;              /* sits behind everything */
  overflow: hidden;
  pointer-events: none;
}

.bg-layer {
  position: absolute;
  inset: 0;
  background-size: cover;
  background-position: center;
  transform: scale(1.03);   /* tiny scale to hide edge jitter */
  filter: saturate(1.05) contrast(1.05);
  opacity: 0;
  transition: opacity 1200ms ease;
}

.bg-layer.show { opacity: 1; }

/* dark overlay so text stays readable */
.bg-overlay {
  position: absolute;
  inset: 0;
  background:
    radial-gradient(1200px 600px at 15% 0%, rgba(11,16,32,.55), rgba(11,16,32,.82) 60%),
    radial-gradient(900px 600px at 85% 15%, rgba(11,16,32,.40), rgba(11,16,32,.82) 60%),
    linear-gradient(to bottom, rgba(11,16,32,.65), rgba(11,16,32,.88));
}

/* OPTIONAL: reduce motion preference */
@media (prefers-reduced-motion: reduce) {
  .bg-layer { transition: none; }
}

  </style>
</head>

<body>
<!-- Rotating background images -->
<div class="bg-rotator" aria-hidden="true">
  <div class="bg-layer" id="bgA"></div>
  <div class="bg-layer" id="bgB"></div>
  <div class="bg-overlay"></div>
</div>

  <header class="topbar">
    <div class="inner">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Australia Trip Journal</h1>
          <p id="subtitle">Itinerary • Posts • Photos • Lists</p>
        </div>
      </div>

      <nav aria-label="Primary">
        <a href="#itinerary">Itinerary</a>
        <a href="#posts">Blog</a>
        <a href="#gallery">Gallery</a>
        <a href="#lists">Lists</a>
        <a href="#contact">Contact</a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <section class="hero">
      <div class="card heroMain">
        <div class="kicker"><span class="dot"></span> Upcoming trip • Australia • <span id="countdownLabel">countdown loading…</span></div>
        <h2 class="heroTitle">From <span>Sydney</span> to <span>the Reef</span> — one big adventure.</h2>
        <p class="heroSub">
          A simple travel blog to keep plans, notes, and highlights in one place. Edit the itinerary, add posts as you go,
          and track packing + budget on mobile.
        </p>

        <div class="heroActions">
          <a class="btn btnPrimary" href="#itinerary">View itinerary</a>
          <button class="btn" id="addPostBtn" type="button">Add a blog post</button>
          <button class="btn" id="exportBtn" type="button">Export as JSON</button>
          <button class="btn" id="importBtn" type="button">Import JSON</button>
          <input id="importFile" type="file" accept="application/json" hidden />
        </div>
      </div>

      <aside class="card heroSide">
        <div class="sectionHeader" style="margin-bottom:10px">
          <div>
            <h2>Trip snapshot</h2>
            <p>Quick info you can edit.</p>
          </div>
        </div>

        <div class="statGrid">
          <div class="stat">
            <div class="label">Dates</div>
            <div class="value" id="tripDates">TBD</div>
            <div class="mini">Edit in settings below</div>
          </div>
          <div class="stat">
            <div class="label">Stops</div>
            <div class="value" id="stopCount">6</div>
            <div class="mini">Customisable</div>
          </div>
          <div class="stat">
            <div class="label">Main theme</div>
            <div class="value">Coast + Cities</div>
            <div class="mini">Beaches, food, nature</div>
          </div>
          <div class="stat">
            <div class="label">Currency</div>
            <div class="value">AUD</div>
            <div class="mini">Budget tracker below</div>
          </div>
        </div>

        <div style="margin-top:12px; padding-top:12px; border-top:1px solid var(--line)">
          <div class="row">
            <div>
              <label for="tripStart" class="sectionHeader" style="margin:0 0 6px"><p style="margin:0">Trip start</p></label>
              <input id="tripStart" type="date" />
            </div>
            <div>
              <label for="tripEnd" class="sectionHeader" style="margin:0 0 6px"><p style="margin:0">Trip end</p></label>
              <input id="tripEnd" type="date" />
            </div>
          </div>
          <div style="margin-top:10px; display:flex; gap:10px; flex-wrap:wrap">
            <button class="btn btnSmall" id="saveDatesBtn" type="button">Save dates</button>
            <button class="btn btnSmall" id="resetBtn" type="button">Reset demo content</button>
          </div>
        </div>
      </aside>
    </section>

    <!-- ITINERARY -->
    <section id="itinerary" class="card section">
      <div class="sectionHeader">
        <div>
          <h2>Itinerary</h2>
          <p>Tap a day to tweak; use this as your live plan.</p>
        </div>
        <div class="controls">
          <button class="btn btnSmall" id="addDayBtn" type="button">Add day</button>
        </div>
      </div>

      <div class="itinerary" id="itineraryList" aria-live="polite"></div>
    </section>

    <div class="grid2">
      <!-- POSTS -->
      <section id="posts" class="card section">
        <div class="sectionHeader">
          <div>
            <h2>Blog posts</h2>
            <p>Draft now, publish later (locally saved).</p>
          </div>
          <div class="controls">
            <button class="btn btnSmall" id="newPostInlineBtn" type="button">New post</button>
          </div>
        </div>

        <div class="posts" id="postList"></div>
      </section>

      <!-- GALLERY -->
      <section id="gallery" class="card section">
        <div class="sectionHeader">
          <div>
            <h2>Photo gallery</h2>
            <p>Placeholder tiles — swap for real photos later.</p>
          </div>
          <div class="controls">
            <button class="btn btnSmall" id="shuffleGalleryBtn" type="button">Shuffle</button>
          </div>
        </div>

        <div class="gallery" id="galleryGrid">
          <div class="ph col-8" data-title="Sydney Harbour at golden hour"><span>Sydney Harbour</span></div>
          <div class="ph col-4" data-title="Bondi coastal walk"><span>Bondi Walk</span></div>
          <div class="ph col-4" data-title="Blue Mountains lookouts"><span>Blue Mountains</span></div>
          <div class="ph col-4" data-title="Melbourne laneways + coffee"><span>Melbourne</span></div>
          <div class="ph col-4" data-title="Great Ocean Road"><span>Great Ocean Rd</span></div>
          <div class="ph col-6" data-title="Uluru sunrise"><span>Uluru</span></div>
          <div class="ph col-6" data-title="Great Barrier Reef day trip"><span>Great Barrier Reef</span></div>
        </div>
      </section>
    </div>

    <!-- LISTS -->
    <section id="lists" class="card section">
      <div class="sectionHeader">
        <div>
          <h2>Lists</h2>
          <p>Packing checklist + budget tracker (stored on this device).</p>
        </div>
      </div>

      <div class="grid2">
        <div>
          <div class="sectionHeader" style="margin-bottom:8px">
            <div>
              <h2 style="font-size:15px; margin:0">Packing list</h2>
              <p style="margin:4px 0 0">Tick items as you pack.</p>
            </div>
            <div class="controls">
              <button class="btn btnSmall" id="addPackItemBtn" type="button">Add item</button>
            </div>
          </div>
          <div class="list" id="packingList"></div>
        </div>

        <div>
          <div class="sectionHeader" style="margin-bottom:8px">
            <div>
              <h2 style="font-size:15px; margin:0">Budget tracker</h2>
              <p style="margin:4px 0 0">Quick spending log in AUD.</p>
            </div>
            <div class="controls">
              <button class="btn btnSmall" id="addExpenseBtn" type="button">Add expense</button>
            </div>
          </div>

          <div class="statGrid" style="margin-bottom:12px">
            <div class="stat">
              <div class="label">Budget</div>
              <div class="value" id="budgetValue">A$ 0</div>
              <div class="mini">Set a target below</div>
            </div>
            <div class="stat">
              <div class="label">Spent</div>
              <div class="value" id="spentValue">A$ 0</div>
              <div class="mini" id="remainingLabel">Remaining: A$ 0</div>
            </div>
          </div>

          <div class="row">
            <div>
              <label class="sectionHeader" style="margin:0 0 6px"><p style="margin:0">Total budget (AUD)</p></label>
              <input id="budgetInput" type="number" step="1" min="0" placeholder="e.g. 4500" />
            </div>
            <div>
              <label class="sectionHeader" style="margin:0 0 6px"><p style="margin:0">Tip</p></label>
              <input value="Use notes like 'Coffee, Fitzroy' or 'Train to Katoomba'" disabled />
            </div>
          </div>
          <div style="margin-top:10px; display:flex; gap:10px; flex-wrap:wrap">
            <button class="btn btnSmall" id="saveBudgetBtn" type="button">Save budget</button>
            <button class="btn btnSmall" id="clearExpensesBtn" type="button">Clear expenses</button>
          </div>

          <div class="posts" id="expenseList" style="margin-top:12px"></div>
        </div>
      </div>
    </section>

    <!-- CONTACT -->
    <section id="contact" class="card section">
      <div class="sectionHeader">
        <div>
          <h2>Contact / Subscribe</h2>
          <p>Front-end only — wire to an email service later.</p>
        </div>
      </div>

      <div class="grid2">
        <form id="contactForm">
          <div class="row">
            <div><input name="name" placeholder="Your name" required /></div>
            <div><input name="email" type="email" placeholder="Email address" required /></div>
          </div>
          <div style="margin-top:12px">
            <textarea name="message" placeholder="Message (or what you'd like updates about)"></textarea>
          </div>
          <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap">
            <button class="btn btnPrimary" type="submit">Send</button>
            <button class="btn" type="button" id="copyLinkBtn">Copy share link</button>
          </div>
          <p style="margin:10px 0 0; color:var(--muted); font-size:12px">
            Tip: Host this for free on GitHub Pages / Netlify by uploading this one file.
          </p>
        </form>

        <div>
          <div class="sectionHeader" style="margin-bottom:8px">
            <div>
              <h2 style="font-size:15px; margin:0">Quick links</h2>
              <p style="margin:4px 0 0">Maps + booking references.</p>
            </div>
          </div>

          <div class="posts">
            <div class="post">
              <div class="postMeta">Maps</div>
              <h3>Australia highlights map</h3>
              <p>Open a simple search in Google Maps. Edit destinations in the URL query.</p>
              <a class="btn btnSmall" target="_blank" rel="noreferrer"
                 href="https://www.google.com/maps/search/?api=1&query=Sydney+Melbourne+Great+Ocean+Road+Uluru+Great+Barrier+Reef">
                Open maps
              </a>
            </div>
            <div class="post">
              <div class="postMeta">Flights</div>
              <h3>Flight notes</h3>
              <p>Add flight numbers, terminals, and backup plans here.</p>
              <button class="btn btnSmall" type="button" onclick="quickNote('Flight notes: ')">Add note</button>
            </div>
            <div class="post">
              <div class="postMeta">Safety</div>
              <h3>Reminders</h3>
              <p>Sun protection, hydration, and local conditions (rips, wildlife, heat).</p>
              <button class="btn btnSmall" type="button" onclick="quickNote('Reminder: ')">Add note</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <p class="footer">
      Built as a single-file travel blog. Your edits save to this browser (localStorage).
    </p>
  </main>

  <!-- Modal -->
  <div class="modal" id="modal" role="dialog" aria-modal="true" aria-label="Preview">
    <div class="modalCard">
      <div class="modalTop">
        <div class="modalTitle" id="modalTitle">Preview</div>
        <button class="btn btnSmall" id="closeModalBtn" type="button">Close</button>
      </div>
      <div class="modalBody">
        <div class="modalImg" id="modalImg" aria-hidden="true"></div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast">Saved</div>

  <script>
    // ---------- Storage ----------
    const KEY = "aus_trip_blog_v1";
    const DEFAULTS = {
      tripStart: "",
      tripEnd: "",
      itinerary: [
        { dateLabel: "Day 1", city: "Sydney", tag: "Arrival", bullets: ["Check in", "Evening harbour walk", "Early night"], mapQuery: "Sydney Opera House" },
        { dateLabel: "Day 2", city: "Sydney", tag: "Coast", bullets: ["Bondi to Coogee walk", "Swim (flags)", "Seafood dinner"], mapQuery: "Bondi Beach" },
        { dateLabel: "Day 3", city: "Blue Mountains", tag: "Nature", bullets: ["Katoomba", "Lookouts", "Sunset photos"], mapQuery: "Blue Mountains Katoomba" },
        { dateLabel: "Day 4", city: "Melbourne", tag: "Food", bullets: ["Laneways + coffee", "NGV or ACMI", "Dinner in Fitzroy"], mapQuery: "Melbourne Fitzroy" },
        { dateLabel: "Day 5", city: "Great Ocean Road", tag: "Road trip", bullets: ["Early start", "12 Apostles", "Back via coastal towns"], mapQuery: "Twelve Apostles Victoria" },
        { dateLabel: "Day 6", city: "Cairns / Reef", tag: "Ocean", bullets: ["Reef day tour", "Snorkel/intro dive", "Lazy evening"], mapQuery: "Great Barrier Reef Cairns" },
      ],
      posts: [
        { id: crypto.randomUUID(), title: "Pre-trip thoughts", date: new Date().toISOString().slice(0,10), location: "Planning", tags: ["planning"], body: "What I’m excited about, what I’m nervous about, and what I’m determined to do on this trip." },
      ],
      packing: [
        { id: crypto.randomUUID(), text: "Passport + copies", done: false },
        { id: crypto.randomUUID(), text: "Sun cream + hat", done: false },
        { id: crypto.randomUUID(), text: "Swimwear", done: false },
        { id: crypto.randomUUID(), text: "Power adapter", done: false },
        { id: crypto.randomUUID(), text: "Comfortable trainers", done: false },
      ],
      budget: 0,
      expenses: [
        { id: crypto.randomUUID(), date: new Date().toISOString().slice(0,10), note: "Airport coffee", amount: 6.5 },
      ]
    };

    function loadState(){
      try{
        const raw = localStorage.getItem(KEY);
        if(!raw) return structuredClone(DEFAULTS);
        const parsed = JSON.parse(raw);
        // shallow merge for new fields
        return { ...structuredClone(DEFAULTS), ...parsed };
      }catch{
        return structuredClone(DEFAULTS);
      }
    }
    function saveState(){
      localStorage.setItem(KEY, JSON.stringify(state));
      toast("Saved");
    }
    function resetState(){
      state = structuredClone(DEFAULTS);
      saveState();
      renderAll();
      toast("Reset demo content");
    }

    let state = loadState();

    // ---------- Helpers ----------
    const $ = (sel)=>document.querySelector(sel);
    const $$ = (sel)=>Array.from(document.querySelectorAll(sel));
    function money(n){
      const val = Number(n||0);
      return "A$ " + val.toLocaleString(undefined, { maximumFractionDigits: 2 });
    }
    let toastTimer;
    function toast(msg){
      const t = $("#toast");
      t.textContent = msg;
      t.classList.add("show");
      clearTimeout(toastTimer);
      toastTimer = setTimeout(()=>t.classList.remove("show"), 1400);
    }
    function daysUntil(dateStr){
      if(!dateStr) return null;
      const d = new Date(dateStr + "T00:00:00");
      const now = new Date();
      const ms = d - now;
      return Math.ceil(ms / (1000*60*60*24));
    }
    function formatDates(start, end){
      if(!start && !end) return "TBD";
      const opts = { year:"numeric", month:"short", day:"numeric" };
      const s = start ? new Date(start+"T00:00:00").toLocaleDateString(undefined, opts) : "—";
      const e = end ? new Date(end+"T00:00:00").toLocaleDateString(undefined, opts) : "—";
      return `${s} → ${e}`;
    }

    // ---------- Itinerary ----------
    function renderItinerary(){
      const list = $("#itineraryList");
      list.innerHTML = "";
      state.itinerary.forEach((d, idx)=>{
        const el = document.createElement("div");
        el.className = "day";
        el.innerHTML = `
          <div>
            <div class="pill">${escapeHtml(d.dateLabel)} <span class="badge">${escapeHtml(d.tag||"")}</span></div>
            <a class="map" target="_blank" rel="noreferrer"
              href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(d.mapQuery || d.city)}">Open map ↗</a>
          </div>
          <div>
            <h3>${escapeHtml(d.city)}</h3>
            <ul>
              ${(d.bullets||[]).map(b=>`<li>${escapeHtml(b)}</li>`).join("")}
            </ul>
            <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap">
              <button class="btn btnSmall" type="button" data-action="edit-day" data-idx="${idx}">Edit</button>
              <button class="btn btnSmall" type="button" data-action="move-up" data-idx="${idx}">Up</button>
              <button class="btn btnSmall" type="button" data-action="move-down" data-idx="${idx}">Down</button>
              <button class="btn btnSmall" type="button" data-action="delete-day" data-idx="${idx}">Delete</button>
            </div>
          </div>
        `;
        list.appendChild(el);
      });
    }

    function addDay(){
      state.itinerary.push({
        dateLabel: `Day ${state.itinerary.length+1}`,
        city: "New stop",
        tag: "Plan",
        bullets: ["One thing to do", "One place to eat", "One photo idea"],
        mapQuery: "Australia"
      });
      saveState();
      renderItinerary();
    }

    function editDay(idx){
      const d = state.itinerary[idx];
      const dateLabel = prompt("Label (e.g., Day 7 or 12 Mar):", d.dateLabel) ?? d.dateLabel;
      const city = prompt("City / region:", d.city) ?? d.city;
      const tag = prompt("Tag (Arrival / Food / Nature etc.):", d.tag ?? "") ?? (d.tag ?? "");
      const bulletsRaw = prompt("Bullets (separate with |):", (d.bullets||[]).join(" | ")) ?? (d.bullets||[]).join(" | ");
      const mapQuery = prompt("Map search query:", d.mapQuery ?? city) ?? (d.mapQuery ?? city);

      state.itinerary[idx] = {
        ...d,
        dateLabel: dateLabel.trim(),
        city: city.trim(),
        tag: tag.trim(),
        bullets: bulletsRaw.split("|").map(s=>s.trim()).filter(Boolean),
        mapQuery: mapQuery.trim()
      };
      saveState();
      renderItinerary();
    }

    function moveDay(idx, dir){
      const j = idx + dir;
      if(j < 0 || j >= state.itinerary.length) return;
      const arr = state.itinerary;
      [arr[idx], arr[j]] = [arr[j], arr[idx]];
      saveState();
      renderItinerary();
    }

    function deleteDay(idx){
      if(!confirm("Delete this day?")) return;
      state.itinerary.splice(idx, 1);
      // renumber labels if they look like "Day N"
      state.itinerary = state.itinerary.map((d,i)=>{
        if(/^Day\s+\d+$/i.test(d.dateLabel.trim())){
          return { ...d, dateLabel: `Day ${i+1}` };
        }
        return d;
      });
      saveState();
      renderItinerary();
    }

    // ---------- Posts ----------
    function renderPosts(){
      const list = $("#postList");
      list.innerHTML = "";
      const posts = [...state.posts].sort((a,b)=> (b.date||"").localeCompare(a.date||""));
      if(posts.length === 0){
        list.innerHTML = `<div class="post"><p>No posts yet. Hit “New post”.</p></div>`;
        return;
      }
      posts.forEach(p=>{
        const el = document.createElement("div");
        el.className = "post";
        el.innerHTML = `
          <div class="postMeta">
            <span>${escapeHtml(p.date || "")}</span>
            <span>•</span>
            <span>${escapeHtml(p.location || "")}</span>
            <span>•</span>
            <span>${(p.tags||[]).map(t=>"#"+escapeHtml(t)).join(" ")}</span>
          </div>
          <h3>${escapeHtml(p.title)}</h3>
          <p>${escapeHtml(truncate(p.body, 210))}</p>
          <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap">
            <button class="btn btnSmall" type="button" data-action="read-post" data-id="${p.id}">Read</button>
            <button class="btn btnSmall" type="button" data-action="edit-post" data-id="${p.id}">Edit</button>
            <button class="btn btnSmall" type="button" data-action="delete-post" data-id="${p.id}">Delete</button>
          </div>
        `;
        list.appendChild(el);
      });
    }

    function newPost(){
      const title = prompt("Post title:", "A day in Australia") || "Untitled";
      const date = prompt("Date (YYYY-MM-DD):", new Date().toISOString().slice(0,10)) || new Date().toISOString().slice(0,10);
      const location = prompt("Location:", "Sydney") || "Australia";
      const tags = (prompt("Tags (comma separated):", "australia,trip") || "")
        .split(",").map(s=>s.trim()).filter(Boolean);
      const body = prompt("Write your post:", "Today’s highlights…") || "";
      state.posts.push({ id: crypto.randomUUID(), title, date, location, tags, body });
      saveState();
      renderPosts();
    }

    function editPost(id){
      const p = state.posts.find(x=>x.id===id);
      if(!p) return;
      const title = prompt("Post title:", p.title) ?? p.title;
      const date = prompt("Date (YYYY-MM-DD):", p.date) ?? p.date;
      const location = prompt("Location:", p.location) ?? p.location;
      const tags = (prompt("Tags (comma separated):", (p.tags||[]).join(", ")) ?? (p.tags||[]).join(", "))
        .split(",").map(s=>s.trim()).filter(Boolean);
      const body = prompt("Body:", p.body) ?? p.body;
      Object.assign(p, { title, date, location, tags, body });
      saveState();
      renderPosts();
    }

    function readPost(id){
      const p = state.posts.find(x=>x.id===id);
      if(!p) return;
      alert(`${p.title}\n\n${p.date} • ${p.location}\n${(p.tags||[]).map(t=>"#"+t).join(" ")}\n\n${p.body}`);
    }

    function deletePost(id){
      if(!confirm("Delete this post?")) return;
      state.posts = state.posts.filter(p=>p.id!==id);
      saveState();
      renderPosts();
    }

    // ---------- Packing ----------
    function renderPacking(){
      const list = $("#packingList");
      list.innerHTML = "";
      state.packing.forEach(item=>{
        const row = document.createElement("div");
        row.className = "listItem";
        row.innerHTML = `
          <label>
            <input type="checkbox" data-action="toggle-pack" data-id="${item.id}" ${item.done ? "checked" : ""} />
            <span>${escapeHtml(item.text)}</span>
          </label>
          <button class="btn btnSmall" type="button" data-action="delete-pack" data-id="${item.id}">Remove</button>
        `;
        list.appendChild(row);
      });
    }

    function addPackItem(){
      const text = prompt("New packing item:", "Something important");
      if(!text) return;
      state.packing.push({ id: crypto.randomUUID(), text: text.trim(), done:false });
      saveState();
      renderPacking();
    }

    // ---------- Budget ----------
    function renderBudget(){
      $("#budgetValue").textContent = money(state.budget);
      const spent = state.expenses.reduce((sum,e)=> sum + Number(e.amount||0), 0);
      $("#spentValue").textContent = money(spent);
      $("#remainingLabel").textContent = "Remaining: " + money((Number(state.budget||0) - spent));

      const list = $("#expenseList");
      list.innerHTML = "";
      const expenses = [...state.expenses].sort((a,b)=> (b.date||"").localeCompare(a.date||""));
      if(expenses.length === 0){
        list.innerHTML = `<div class="post"><p>No expenses yet.</p></div>`;
        return;
      }
      expenses.forEach(e=>{
        const el = document.createElement("div");
        el.className = "post";
        el.innerHTML = `
          <div class="postMeta">${escapeHtml(e.date)} • ${escapeHtml(e.note)}</div>
          <h3 style="margin:8px 0 0">${money(e.amount)}</h3>
          <div style="margin-top:10px">
            <button class="btn btnSmall" type="button" data-action="delete-expense" data-id="${e.id}">Delete</button>
          </div>
        `;
        list.appendChild(el);
      });
    }

    function addExpense(){
      const date = prompt("Date (YYYY-MM-DD):", new Date().toISOString().slice(0,10)) || new Date().toISOString().slice(0,10);
      const note = prompt("Note:", "Lunch / taxi / tickets") || "Expense";
      const amount = Number(prompt("Amount (AUD):", "10") || "0");
      state.expenses.push({ id: crypto.randomUUID(), date, note, amount });
      saveState();
      renderBudget();
    }

    // ---------- Gallery / Modal ----------
    function openModal(title){
      $("#modalTitle").textContent = title;
      $("#modal").classList.add("show");
    }
    function closeModal(){
      $("#modal").classList.remove("show");
    }
    function shuffleGallery(){
      const grid = $("#galleryGrid");
      const items = Array.from(grid.children);
      for(let i = items.length - 1; i > 0; i--){
        const j = Math.floor(Math.random() * (i+1));
        [items[i], items[j]] = [items[j], items[i]];
      }
      items.forEach(it=>grid.appendChild(it));
      toast("Shuffled");
    }

    // ---------- Export / Import ----------
    function exportJSON(){
      const data = JSON.stringify(state, null, 2);
      const blob = new Blob([data], {type:"application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "australia-trip-blog.json";
      a.click();
      URL.revokeObjectURL(url);
      toast("Exported");
    }
    function importJSON(file){
      const reader = new FileReader();
      reader.onload = ()=>{
        try{
          const obj = JSON.parse(String(reader.result || ""));
          state = { ...structuredClone(DEFAULTS), ...obj };
          saveState();
          renderAll();
          toast("Imported");
        }catch{
          alert("That file didn't look like valid JSON for this site.");
        }
      };
      reader.readAsText(file);
    }

    // ---------- Misc ----------
    function quickNote(prefix){
      const note = prompt(prefix + "Write a quick note:", "");
      if(!note) return;
      state.posts.push({
        id: crypto.randomUUID(),
        title: prefix.trim(),
        date: new Date().toISOString().slice(0,10),
        location: "Notes",
        tags: ["note"],
        body: note
      });
      saveState();
      renderPosts();
      toast("Note added");
    }
    window.quickNote = quickNote;

    function truncate(str, n){
      if(!str) return "";
      return str.length > n ? str.slice(0, n-1) + "…" : str;
    }
    function escapeHtml(str){
      return String(str ?? "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function updateCountdown(){
      const start = state.tripStart;
      const end = state.tripEnd;

      $("#tripDates").textContent = formatDates(start, end);

      const d = daysUntil(start);
      if(d === null){
        $("#countdownLabel").textContent = "set your dates";
        return;
      }
      if(d > 1) $("#countdownLabel").textContent = `${d} days to go`;
      else if(d === 1) $("#countdownLabel").textContent = "tomorrow";
      else if(d === 0) $("#countdownLabel").textContent = "starts today";
      else $("#countdownLabel").textContent = "trip started";
    }

    function renderAll(){
      $("#tripStart").value = state.tripStart || "";
      $("#tripEnd").value = state.tripEnd || "";
      $("#stopCount").textContent = String(state.itinerary.length);

      $("#budgetInput").value = state.budget || "";
      renderItinerary();
      renderPosts();
      renderPacking();
      renderBudget();
      updateCountdown();
    }

    // ---------- Event wiring ----------
    document.addEventListener("click", (e)=>{
      const btn = e.target.closest("[data-action]");
      if(!btn) return;
      const action = btn.getAttribute("data-action");
      const idx = Number(btn.getAttribute("data-idx"));
      const id = btn.getAttribute("data-id");

      if(action==="edit-day") editDay(idx);
      if(action==="move-up") moveDay(idx, -1);
      if(action==="move-down") moveDay(idx, +1);
      if(action==="delete-day") deleteDay(idx);

      if(action==="read-post") readPost(id);
      if(action==="edit-post") editPost(id);
      if(action==="delete-post") deletePost(id);

      if(action==="delete-pack"){
        state.packing = state.packing.filter(x=>x.id!==id);
        saveState(); renderPacking();
      }
      if(action==="delete-expense"){
        state.expenses = state.expenses.filter(x=>x.id!==id);
        saveState(); renderBudget();
      }
    });

    document.addEventListener("change", (e)=>{
      const el = e.target;
      if(el.matches('input[type="checkbox"][data-action="toggle-pack"]')){
        const id = el.getAttribute("data-id");
        const item = state.packing.find(x=>x.id===id);
        if(item){ item.done = el.checked; saveState(); }
      }
    });

    // Buttons
    $("#addDayBtn").addEventListener("click", addDay);
    $("#newPostInlineBtn").addEventListener("click", newPost);
    $("#addPostBtn").addEventListener("click", newPost);
    $("#addPackItemBtn").addEventListener("click", addPackItem);
    $("#addExpenseBtn").addEventListener("click", addExpense);
    $("#shuffleGalleryBtn").addEventListener("click", shuffleGallery);

    $("#saveDatesBtn").addEventListener("click", ()=>{
      state.tripStart = $("#tripStart").value || "";
      state.tripEnd = $("#tripEnd").value || "";
      saveState();
      updateCountdown();
      toast("Dates saved");
    });

    $("#saveBudgetBtn").addEventListener("click", ()=>{
      const v = Number($("#budgetInput").value || "0");
      state.budget = isFinite(v) ? v : 0;
      saveState();
      renderBudget();
      toast("Budget saved");
    });

    $("#clearExpensesBtn").addEventListener("click", ()=>{
      if(!confirm("Clear all expenses?")) return;
      state.expenses = [];
      saveState();
      renderBudget();
      toast("Cleared");
    });

    $("#resetBtn").addEventListener("click", resetState);

    $("#exportBtn").addEventListener("click", exportJSON);

    $("#importBtn").addEventListener("click", ()=> $("#importFile").click());
    $("#importFile").addEventListener("change", (e)=>{
      const file = e.target.files?.[0];
      if(file) importJSON(file);
      e.target.value = "";
    });

    // Contact form (front-end only)
    $("#contactForm").addEventListener("submit", (e)=>{
      e.preventDefault();
      toast("Message saved locally (demo)");
      const fd = new FormData(e.target);
      // Add as a note post
      state.posts.push({
        id: crypto.randomUUID(),
        title: "Message",
        date: new Date().toISOString().slice(0,10),
        location: "Contact",
        tags: ["message"],
        body: `From: ${fd.get("name")} <${fd.get("email")}>\n\n${fd.get("message") || ""}`
      });
      saveState();
      renderPosts();
      e.target.reset();
    });

    // Share link (copies current URL)
    $("#copyLinkBtn").addEventListener("click", async ()=>{
      try{
        await navigator.clipboard.writeText(location.href);
        toast("Link copied");
      }catch{
        alert("Couldn’t copy automatically — copy the URL from your address bar.");
      }
    });

    // Gallery click opens modal
    $$("#galleryGrid .ph").forEach(ph=>{
      ph.addEventListener("click", ()=> openModal(ph.getAttribute("data-title") || "Photo"));
    });
    $("#closeModalBtn").addEventListener("click", closeModal);
    $("#modal").addEventListener("click", (e)=>{ if(e.target.id==="modal") closeModal(); });
    document.addEventListener("keydown", (e)=>{ if(e.key==="Escape") closeModal(); });
// ---------- Rotating Australia background photos ----------
const BG_INTERVAL_MS = 12000; // change rotation speed here

// Using Unsplash "source" images (stock-photo style). No API key needed.
// Note: these URLs can occasionally repeat; adding `sig` helps randomize.
const bgQueries = [
  "australia,landscape",
  "sydney,opera-house",
  "melbourne,city",
  "great+ocean+road",
  "uluru,australia",
  "great+barrier+reef",
  "brisbane,australia",
  "tasmania,nature",
  "perth,coast",
  "blue+mountains,australia"
];

function unsplashUrl(query, sig) {
  // 2400x1600 is a good balance of quality/perf for full-screen backgrounds
  return `https://source.unsplash.com/2400x1600/?${encodeURIComponent(query)}&sig=${sig}`;
}

let bgSig = 1;
let bgIndex = 0;
let showingA = true;

const bgA = document.getElementById("bgA");
const bgB = document.getElementById("bgB");

// Preload helper so we only fade once the image is ready
function preload(url) {
  return new Promise((resolve) => {
    const img = new Image();
    img.onload = () => resolve(url);
    img.onerror = () => resolve(url); // fail-soft: still try to display
    img.src = url;
  });
}

async function setNextBackground(initial = false) {
  const query = bgQueries[bgIndex % bgQueries.length];
  const url = unsplashUrl(query, bgSig++);

  bgIndex++;

  const readyUrl = await preload(url);

  const incoming = showingA ? bgB : bgA;
  const outgoing = showingA ? bgA : bgB;

  incoming.style.backgroundImage = `url("${readyUrl}")`;
  incoming.classList.add("show");
  outgoing.classList.remove("show");

  showingA = !showingA;

  if (initial) {
    // ensure one layer is visible on load
    incoming.classList.add("show");
  }
}

// Start rotation
(async function initRotatingBackground(){
  // Respect reduced motion: keep one static image
  if (window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
    const query = bgQueries[0];
    const url = unsplashUrl(query, bgSig++);
    bgA.style.backgroundImage = `url("${url}")`;
    bgA.classList.add("show");
    return;
  }

  await setNextBackground(true);
  setInterval(setNextBackground, BG_INTERVAL_MS);
})();
    // Init
    renderAll();
    setInterval(updateCountdown, 30_000);


  </script>
</body>
</html>
